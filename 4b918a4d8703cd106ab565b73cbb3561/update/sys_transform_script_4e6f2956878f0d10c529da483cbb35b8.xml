<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_script">
    <sys_transform_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <map display_value="CyCognito Issues Transfer">d46d14c6878341506ab565b73cbb35bb</map>
        <order>100</order>
        <script><![CDATA[(function runTransformScript(source, map, log, target /*undefined onStart*/ ) {

    try {

        if (ignore || error)
            x_cyin_cycognito.vul_item_ignored++;
        else {
            if (action == "update")
                x_cyin_cycognito.vul_item_updated++;
            if (action == "insert")
                x_cyin_cycognito.vul_item_created++;
        }

        var description = "";
        description += source.u_summary + '';
        description += "\nIssue type: " + source.u_issue_type;
        description += "\nSeverity: " + source.u_severity;
        description += "\nSeverity Score: " + source.u_severity_score;
        description += "\nExploitation Method: " + source.u_exploitation_method;
        description += "\nFirst Detected: " + source.u_first_detected;
        description += "\nLast Detected: " + source.u_last_detected;
        target.setValue("description", description);

        // Add your code here
        var tzfirstdate = source.u_first_detected + "";
        tzfirstdate = tzfirstdate.replace('T', ' ').replace('Z', ' ');
        target.setValue("first_found", tzfirstdate);

        var tzlastdate = source.u_last_detected + "";
        tzlastdate = tzlastdate.replace('T', ' ').replace('Z', ' ');
        target.setValue("last_found", tzlastdate);

        var tzresolvedate = source.u_resolved_at + "";
        tzresolvedate = tzresolvedate.replace('T', ' ').replace('Z', ' ');
        target.setValue("resolution_date", tzresolvedate);

//         var severity = source.u_severity;
//         if (severity == 'critical') {
//             target.setValue("risk_rating", 1);
//         } else if (severity == 'high') {
//             target.setValue("risk_rating", 2);
//         } else if (severity == 'medium') {
//             target.setValue("risk_rating", 3);
//         } else if (severity == 'low') {
//             target.setValue("risk_rating", 4);
//         } else {
//             target.setValue("risk_rating", 5);
//         }

        var cmdbGr = new GlideRecord("cmdb_ci");
        if (cmdbGr.get("serial_number", source.u_target)) {
            target.cmdb_ci = cmdbGr.getUniqueValue();
        }

        target.source = "CyCognito";
    } catch (ex) {
        gs.error("[onBefore] Error while processing CyCognito Issues. Excepiton: " + ex);
    }


})(source, map, log, target);]]></script>
        <sys_class_name>sys_transform_script</sys_class_name>
        <sys_created_by>tap-crestds</sys_created_by>
        <sys_created_on>2022-04-26 06:45:16</sys_created_on>
        <sys_id>4e6f2956878f0d10c529da483cbb35b8</sys_id>
        <sys_mod_count>12</sys_mod_count>
        <sys_name>onBefore</sys_name>
        <sys_package display_value="CyCognito App for Vulnerability Response" source="x_cyin_cycognito">4b918a4d8703cd106ab565b73cbb3561</sys_package>
        <sys_policy/>
        <sys_scope display_value="CyCognito App for Vulnerability Response">4b918a4d8703cd106ab565b73cbb3561</sys_scope>
        <sys_update_name>sys_transform_script_4e6f2956878f0d10c529da483cbb35b8</sys_update_name>
        <sys_updated_by>tap-crestds</sys_updated_by>
        <sys_updated_on>2022-05-17 06:17:59</sys_updated_on>
        <when>onBefore</when>
    </sys_transform_script>
</record_update>
